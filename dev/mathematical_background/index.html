<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Van Vleck Recursion: Mathematical Background · VanVleckRecursion.jl</title><meta name="title" content="Van Vleck Recursion: Mathematical Background · VanVleckRecursion.jl"/><meta property="og:title" content="Van Vleck Recursion: Mathematical Background · VanVleckRecursion.jl"/><meta property="twitter:title" content="Van Vleck Recursion: Mathematical Background · VanVleckRecursion.jl"/><meta name="description" content="Documentation for VanVleckRecursion.jl."/><meta property="og:description" content="Documentation for VanVleckRecursion.jl."/><meta property="twitter:description" content="Documentation for VanVleckRecursion.jl."/><meta property="og:url" content="https://oameye.github.io/VanVleckRecursion.jl/mathematical_background/"/><meta property="twitter:url" content="https://oameye.github.io/VanVleckRecursion.jl/mathematical_background/"/><link rel="canonical" href="https://oameye.github.io/VanVleckRecursion.jl/mathematical_background/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">VanVleckRecursion.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../API/">API</a></li><li><a class="tocitem" href="../literature/">Literature</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/van_Vleck_expansion_method/">van Vleck expansion</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Van Vleck Recursion: Mathematical Background</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Van Vleck Recursion: Mathematical Background</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/oameye/VanVleckRecursion.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/oameye/VanVleckRecursion.jl/blob/main/docs/src/mathematical_background.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Van-Vleck-Recursion:-Mathematical-Background"><a class="docs-heading-anchor" href="#Van-Vleck-Recursion:-Mathematical-Background">Van Vleck Recursion: Mathematical Background</a><a id="Van-Vleck-Recursion:-Mathematical-Background-1"></a><a class="docs-heading-anchor-permalink" href="#Van-Vleck-Recursion:-Mathematical-Background" title="Permalink"></a></h1><p>This document provides a detailed mathematical explanation of the Van Vleck canonical transformation as implemented in VanVleckRecursion.jl, based on the theoretical framework from Venkatraman et al. (2022).</p><h2 id="Physical-Problem"><a class="docs-heading-anchor" href="#Physical-Problem">Physical Problem</a><a id="Physical-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-Problem" title="Permalink"></a></h2><h3 id="Driven-Quantum-Systems"><a class="docs-heading-anchor" href="#Driven-Quantum-Systems">Driven Quantum Systems</a><a id="Driven-Quantum-Systems-1"></a><a class="docs-heading-anchor-permalink" href="#Driven-Quantum-Systems" title="Permalink"></a></h3><p>Consider a quantum system with time-dependent Hamiltonian:</p><pre><code class="nohighlight hljs">H(t) = H₀ + H₁cos(ωt) + H₂cos(2ωt) + ...</code></pre><p>Where:</p><ul><li><code>H₀</code>: Static (time-independent) Hamiltonian</li><li><code>H₁cos(ωt)</code>: Primary oscillating drive at frequency ω</li><li>Higher harmonics can also be included</li></ul><h3 id="The-Secular-Problem"><a class="docs-heading-anchor" href="#The-Secular-Problem">The Secular Problem</a><a id="The-Secular-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#The-Secular-Problem" title="Permalink"></a></h3><p>Traditional time-dependent perturbation theory often produces terms that grow linearly in time (secular terms):</p><pre><code class="nohighlight hljs">|ψ(t)⟩ ≈ |ψ₀⟩ + εt|ψ₁⟩ + ε²t²|ψ₂⟩ + ...</code></pre><p>These secular terms invalidate the perturbative expansion for long times t &gt;&gt; 1/ε, making traditional approaches unsuitable for understanding long-time dynamics.</p><h3 id="Van-Vleck-Solution"><a class="docs-heading-anchor" href="#Van-Vleck-Solution">Van Vleck Solution</a><a id="Van-Vleck-Solution-1"></a><a class="docs-heading-anchor-permalink" href="#Van-Vleck-Solution" title="Permalink"></a></h3><p>The Van Vleck method eliminates secular terms by finding a canonical transformation to a time-independent effective Hamiltonian:</p><pre><code class="nohighlight hljs">H_eff = e^S H(t) e^(-S) - iℏ e^S (∂e^(-S)/∂t)</code></pre><p>Where <code>S = S₁ + S₂ + ...</code> is constructed order by order to eliminate time dependence.</p><h2 id="Mathematical-Framework"><a class="docs-heading-anchor" href="#Mathematical-Framework">Mathematical Framework</a><a id="Mathematical-Framework-1"></a><a class="docs-heading-anchor-permalink" href="#Mathematical-Framework" title="Permalink"></a></h2><h3 id="Canonical-Transformation"><a class="docs-heading-anchor" href="#Canonical-Transformation">Canonical Transformation</a><a id="Canonical-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Canonical-Transformation" title="Permalink"></a></h3><p>The Van Vleck transformation uses a near-identity canonical transformation generated by <code>S</code>:</p><ul><li><strong>Classical</strong>: <code>{F, S}</code> (Poisson bracket with generating function S)</li><li><strong>Quantum</strong>: <code>[F, S]/iℏ</code> (commutator with generator S)</li></ul><h3 id="Rotating-Wave-Approximation"><a class="docs-heading-anchor" href="#Rotating-Wave-Approximation">Rotating Wave Approximation</a><a id="Rotating-Wave-Approximation-1"></a><a class="docs-heading-anchor-permalink" href="#Rotating-Wave-Approximation" title="Permalink"></a></h3><p>The method systematically separates terms by their time dependence:</p><ul><li><strong>Static terms</strong> (rotating=0): Time-independent, contribute to effective Hamiltonian</li><li><strong>Oscillating terms</strong> (rotating=1): Time-dependent, average to zero or generate corrections</li></ul><h3 id="Frequency-Ordering"><a class="docs-heading-anchor" href="#Frequency-Ordering">Frequency Ordering</a><a id="Frequency-Ordering-1"></a><a class="docs-heading-anchor-permalink" href="#Frequency-Ordering" title="Permalink"></a></h3><p>In the high-frequency limit ω → ∞, terms are ordered by powers of 1/ω:</p><pre><code class="nohighlight hljs">H_eff = H₀ + (1/ω)H⁽¹⁾ + (1/ω²)H⁽²⁾ + ...</code></pre><h2 id="Recursive-Formulas"><a class="docs-heading-anchor" href="#Recursive-Formulas">Recursive Formulas</a><a id="Recursive-Formulas-1"></a><a class="docs-heading-anchor-permalink" href="#Recursive-Formulas" title="Permalink"></a></h2><h3 id="Kamiltonian-K(n,k)"><a class="docs-heading-anchor" href="#Kamiltonian-K(n,k)">Kamiltonian K(n,k)</a><a id="Kamiltonian-K(n,k)-1"></a><a class="docs-heading-anchor-permalink" href="#Kamiltonian-K(n,k)" title="Permalink"></a></h3><p>The effective Hamiltonian is built from Kamiltonian contributions:</p><pre><code class="nohighlight hljs">H_eff = Σₙ Σₖ K(n,k)</code></pre><p>Where:</p><ul><li><code>n</code>: Perturbative order (power of coupling strength)</li><li><code>k</code>: Frequency order (power of 1/ω)</li></ul><p><strong>Base Case:</strong></p><pre><code class="nohighlight hljs">K(0,0) = H₀  (unperturbed Hamiltonian)</code></pre><p><strong>Recursive Relations:</strong></p><pre><code class="nohighlight hljs">K(0,1) = Ṡ(1)                                    (time derivative of first generator)
K(n,1) = Ṡ(n+1) + {S(n), K(0,0)}                (for n ≠ 0)
K(n,k) = (1/k) Σₘ₌₀ⁿ⁻¹ {S(n-m), K(m,k-1)}      (for 1 &lt; k ≤ n+1)
K(n,k) = 0                                       (for k &gt; n+1)</code></pre><h3 id="Generator-S(n)"><a class="docs-heading-anchor" href="#Generator-S(n)">Generator S(n)</a><a id="Generator-S(n)-1"></a><a class="docs-heading-anchor-permalink" href="#Generator-S(n)" title="Permalink"></a></h3><p>Generators eliminate oscillating terms through canonical transformations:</p><p><strong>Construction:</strong></p><pre><code class="nohighlight hljs">S(n) = ∫ rot([oscillating parts of expression]) dt</code></pre><p><strong>Recursive Formula:</strong></p><pre><code class="nohighlight hljs">S(0) = 0                                         (no zeroth-order transformation)
S(1) = ∫ rot([-K(0,0)]) dt                      (eliminate static H₀ oscillations)
S(n) = ∫ rot([-{S(n-1), K(0,0)} - Σₖ₌₂ⁿ K(n-1,k)]) dt  (for n &gt; 1)</code></pre><h2 id="Key-Operations"><a class="docs-heading-anchor" href="#Key-Operations">Key Operations</a><a id="Key-Operations-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Operations" title="Permalink"></a></h2><h3 id="Bracket-Operation:-{A,-B}"><a class="docs-heading-anchor" href="#Bracket-Operation:-{A,-B}">Bracket Operation: {A, B}</a><a id="Bracket-Operation:-{A,-B}-1"></a><a class="docs-heading-anchor-permalink" href="#Bracket-Operation:-{A,-B}" title="Permalink"></a></h3><p>Represents Poisson brackets (classical) or commutators (quantum):</p><ul><li><strong>Classical</strong>: <code>{A, B} = ∂A/∂q ∂B/∂p - ∂A/∂p ∂B/∂q</code></li><li><strong>Quantum</strong>: <code>[A, B] = A \cdot B - B \cdot A</code> (in units where ℏ=1)</li></ul><p><strong>Rotation Rules:</strong></p><ul><li><code>{static, oscillating} → oscillating</code></li><li><code>{static, static} → static</code></li><li><code>{oscillating, oscillating} → static + oscillating</code></li></ul><h3 id="Time-Derivative:-Ṡ"><a class="docs-heading-anchor" href="#Time-Derivative:-Ṡ">Time Derivative: Ṡ</a><a id="Time-Derivative:-Ṡ-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Derivative:-Ṡ" title="Permalink"></a></h3><p>Time derivatives of generators appear in Kamiltonian formulas:</p><ul><li><code>∂/∂t [static] = 0</code></li><li><code>∂/∂t [A cos(ωt)] = -ωA sin(ωt) ~ -iωA e^(iωt)</code></li></ul><h3 id="Rotation-Operation:-rot(·)"><a class="docs-heading-anchor" href="#Rotation-Operation:-rot(·)">Rotation Operation: rot(·)</a><a id="Rotation-Operation:-rot(·)-1"></a><a class="docs-heading-anchor-permalink" href="#Rotation-Operation:-rot(·)" title="Permalink"></a></h3><p>Extracts oscillating components for integration:</p><ul><li><code>rot(static) = 0</code></li><li><code>rot(oscillating) = oscillating</code></li></ul><h3 id="Time-Integration:-dt"><a class="docs-heading-anchor" href="#Time-Integration:-dt">Time Integration: ∫ dt</a><a id="Time-Integration:-dt-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Integration:-dt" title="Permalink"></a></h3><p>Integrates oscillating terms to build generators:</p><ul><li><code>∫ A cos(ωt) dt = (A/ω) sin(ωt)</code></li><li>Static terms cannot be integrated (would create secular terms)</li></ul><h2 id="Physical-Interpretation"><a class="docs-heading-anchor" href="#Physical-Interpretation">Physical Interpretation</a><a id="Physical-Interpretation-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-Interpretation" title="Permalink"></a></h2><h3 id="Order-by-Order-Analysis"><a class="docs-heading-anchor" href="#Order-by-Order-Analysis">Order by Order Analysis</a><a id="Order-by-Order-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Order-by-Order-Analysis" title="Permalink"></a></h3><p><strong>Zeroth Order (n=0):</strong></p><ul><li><code>K(0,0) = H₀</code>: Original static Hamiltonian</li><li><code>K(0,1) = Ṡ(1)</code>: First frequency correction</li></ul><p><strong>First Order (n=1):</strong></p><ul><li><code>S(1)</code>: Eliminates first-order oscillations from H₁cos(ωt)</li><li><code>K(1,1) = Ṡ(2) + {S(1), H₀}</code>: Second-order effective terms</li></ul><p><strong>Higher Orders:</strong> Each order systematically eliminates oscillations and generates effective static terms at appropriate frequency orders.</p><h3 id="Frequency-Expansion"><a class="docs-heading-anchor" href="#Frequency-Expansion">Frequency Expansion</a><a id="Frequency-Expansion-1"></a><a class="docs-heading-anchor-permalink" href="#Frequency-Expansion" title="Permalink"></a></h3><p>The effective Hamiltonian has the structure:</p><pre><code class="nohighlight hljs">H_eff = H₀ + (ε/ω)H⁽¹⁾ + (ε²/ω)H⁽²⁾ + (ε²/ω²)H⁽³⁾ + ...</code></pre><p>Where ε is the drive strength and ω is the drive frequency.</p><h2 id="Implementation-Features"><a class="docs-heading-anchor" href="#Implementation-Features">Implementation Features</a><a id="Implementation-Features-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation-Features" title="Permalink"></a></h2><h3 id="Exact-Arithmetic"><a class="docs-heading-anchor" href="#Exact-Arithmetic">Exact Arithmetic</a><a id="Exact-Arithmetic-1"></a><a class="docs-heading-anchor-permalink" href="#Exact-Arithmetic" title="Permalink"></a></h3><p>The Julia implementation uses <code>Rational{Int64}</code> for exact calculations, avoiding floating-point errors that can accumulate in high-order perturbation theory.</p><h3 id="Caching-Strategy"><a class="docs-heading-anchor" href="#Caching-Strategy">Caching Strategy</a><a id="Caching-Strategy-1"></a><a class="docs-heading-anchor-permalink" href="#Caching-Strategy" title="Permalink"></a></h3><p>Both generators and Kamiltonians are cached using global dictionaries:</p><ul><li><code>KAMILTONIAN_CACHE::Dict{Tuple{Int,Int},Terms}</code></li><li><code>GENERATOR_CACHE::Dict{Int,Terms}</code></li></ul><p>This prevents expensive recomputation of overlapping subproblems in the recursive structure.</p><h3 id="Term-Representation"><a class="docs-heading-anchor" href="#Term-Representation">Term Representation</a><a id="Term-Representation-1"></a><a class="docs-heading-anchor-permalink" href="#Term-Representation" title="Permalink"></a></h3><p>Each term tracks:</p><ul><li>Rotation character (static vs oscillating)</li><li>Numerical factor (with exact rational arithmetic)</li><li>Frequency dependence (powers of 1/ω)</li><li>Operational history (bracket structure)</li></ul><h2 id="Applications"><a class="docs-heading-anchor" href="#Applications">Applications</a><a id="Applications-1"></a><a class="docs-heading-anchor-permalink" href="#Applications" title="Permalink"></a></h2><h3 id="Quantum-Engineering"><a class="docs-heading-anchor" href="#Quantum-Engineering">Quantum Engineering</a><a id="Quantum-Engineering-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Engineering" title="Permalink"></a></h3><ul><li><strong>Effective Hamiltonians</strong>: Design target interactions through driving</li><li><strong>Topological Phases</strong>: Create artificial gauge fields</li><li><strong>Quantum Gates</strong>: Robust gate operations in driven systems</li></ul><h3 id="Atomic-Physics"><a class="docs-heading-anchor" href="#Atomic-Physics">Atomic Physics</a><a id="Atomic-Physics-1"></a><a class="docs-heading-anchor-permalink" href="#Atomic-Physics" title="Permalink"></a></h3><ul><li><strong>AC Stark Shifts</strong>: Light-atom interactions in oscillating fields</li><li><strong>Ion Traps</strong>: Eliminate micromotion effects</li><li><strong>Optical Lattices</strong>: Engineer effective hopping and interactions</li></ul><h3 id="Condensed-Matter"><a class="docs-heading-anchor" href="#Condensed-Matter">Condensed Matter</a><a id="Condensed-Matter-1"></a><a class="docs-heading-anchor-permalink" href="#Condensed-Matter" title="Permalink"></a></h3><ul><li><strong>Floquet Engineering</strong>: Periodically driven many-body systems</li><li><strong>Artificial Magnetism</strong>: Effective magnetic fields in neutral systems</li><li><strong>Topological Insulators</strong>: Driven phases of matter</li></ul><h2 id="Advantages-Over-Traditional-Methods"><a class="docs-heading-anchor" href="#Advantages-Over-Traditional-Methods">Advantages Over Traditional Methods</a><a id="Advantages-Over-Traditional-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Advantages-Over-Traditional-Methods" title="Permalink"></a></h2><ol><li><strong>No Secular Divergences</strong>: Systematic elimination of secular terms</li><li><strong>Arbitrary Order</strong>: Can be computed to any desired precision</li><li><strong>Universal Framework</strong>: Works for both quantum and classical systems</li><li><strong>Computer-Friendly</strong>: Designed for symbolic/exact computation</li><li><strong>Physical Insight</strong>: Clear separation of static and oscillating contributions</li></ol><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p><strong>Primary Reference:</strong> Venkatraman, J., Xiao, X., Cortiñas, R. G., Eickbusch, A., &amp; Devoret, M. H. (2022). On the static effective Hamiltonian of a rapidly driven nonlinear system. <em>Physical Review Letters</em>, 129(10), 100601. arXiv:2108.02861</p><p><strong>Related Theory:</strong></p><ul><li>Van Vleck, J. H. (1929). The correspondence principle in the statistical interpretation of quantum mechanics. <em>PNAS</em>, 14(2), 178-188.</li><li>Eckardt, A. (2017). Colloquium: Atomic quantum gases in periodically driven optical lattices. <em>Reviews of Modern Physics</em>, 89(1), 011004.</li><li>Bukov, M., D&#39;Alessio, L., &amp; Polkovnikov, A. (2015). Universal high-frequency behavior of periodically driven systems. <em>Advances in Physics</em>, 64(2), 139-226.</li></ul></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Sunday 8 June 2025 15:41">Sunday 8 June 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
